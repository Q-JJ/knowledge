---
icon: date
order: 5
headerDepth: 3
date: 2022-07-23
readingTime: N/A
word: N/A
lastUpdated: true
article: false
---
# 页面相关

## 网页生成过程

- `HTML`被HTML解析器解析成`DOM` 树
- `css`则被css解析器解析成`CSSOM `树
- 结合`DOM`树和`CSSOM`树，生成一棵渲染树(`Render Tree`)
- 生成布局（`flow`），即将所有渲染树的所有节点进行平面合成
- 将布局绘制（`paint`）在屏幕上

## 输入URL到页面加载的全过程

1. 首先在浏览器中输入URL并回车
2. 浏览器查找当前URL是否存在缓存（查看浏览器缓存-系统缓存-路由缓存），并比较缓存是否过期。有则显示页面内容，没有下一步
3. DNS解析URL对应IP。DNS服务器是基于UDP的，因此会用到UDP协议。
4. 建立TCP连接，三次握手
5. 发送http请求
6. 服务器响应请求并返回结果
7. 关闭TCP连接，四次挥手
8. 浏览器解析并渲染页面
9. 生成DOM树，解析CSS与JS
10. 客户端与服务器交互
11. ajax查询

## SPA单页面

SPA仅在 web 页面初始化时加载相应的 HTML、JavaScript 和 CSS。

一旦页面加载完成，SPA 不会因为用户的操作而进行页面的重新加载或跳转；取而代之的是利用路由机制实现 HTML 内容的变换，UI与用户的交互，避免页面的重新加载。

优点：
- 代码复用
- 用户体验好、快，内容的改变不需要重新加载整个页面，避免了不必要的跳转和重复渲染；
- SPA 相对对服务器压力小;
- 前后端职责分离，架构清晰，前端进行交互逻辑，后端负责数据处理;

缺点：

- 初次加载耗时多：为实现单页 web 应用功能及显示效果，需要在加载页面的时候将 JavaScript、Css 统一加载，部分页面按需加载;
- 前进后退路由管理：由于单页应用在一个页面中显示所有的内容，所以不能使用浏览器的前进后退功能，所有的页面切换需要自己建立堆栈管理；
- SEO 难度较大
- 较高的内存占用


## 页面性能优化

- 资源压缩合并，减少http请求
  - 合并图片（css sprites）、CSS和JS文件合并、CSS和JS文件压缩
  - 使用 lazyLoad 等技术进行优化。
  - 精灵图
- **非核心代码异步加载** --> 异步加载的方式 --> 异步加载的区别
  - 动态脚本加载
  - defer
  - async（H5）
  - defer和async的区别
    - defer：在HTML解析完之后才会执行。如果是多个，则按照加载的顺序依次执行。
    - async：在加载完之后立即执行。如果是多个，执行顺序和加载顺序无关。

- 利用浏览器缓存 --> 缓存的分类 --> 缓存的原理
  - 强缓存：不用请求服务器，直接使用本地的缓存。
  - 协商缓存：浏览器发现本地有资源的副本，但是不太确定要不要使用，于是去问问服务器。

- 使用CDN：浏览器第一次打开页面的时候，浏览器缓存是起不了作任何用的

- DNS预解析：告诉浏览器未来可能从某个 URL 获取资源，当浏览器真正使用到该域中的某个资源时就可以尽快地完成 DNS 解析。